var g=Object.defineProperty;var w=(n,t,e)=>t in n?g(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var h=(n,t,e)=>w(n,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function s(i){if(i.ep)return;i.ep=!0;const r=e(i);fetch(i.href,r)}})();class c{constructor(t,e){h(this,"x",0);h(this,"y",0);this.x=t,this.y=e}}class m{constructor(t,e){h(this,"x",0);h(this,"y",0);h(this,"w",0);h(this,"h",0);h(this,"r",0);h(this,"color","");h(this,"name","H");h(this,"vx",0);h(this,"vy",0);this.sw=t,this.sh=e}initializeDrawingProperties(t){const s=document.createElement("canvas").getContext("2d");if(!s)throw new Error("Failed to get canvas 2D context");const i=24*this.getScale();s.font=`${i}px sans-serif`;const r=s.measureText(this.getName()).width;this.x=t.x,this.y=t.y,this.w=r,this.h=r,this.r=r/2,this.color=this.getColor()}getName(){return this.name}getX(){return this.x}getY(){return this.y}getRadius(){return this.r}render(t){t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.color,t.shadowColor="#888",t.shadowOffsetX=1,t.shadowOffsetY=1,t.shadowBlur=1;const e=24*this.getScale();t.font=`${e}px sans-serif`,t.fillText(this.getName(),this.x,this.y)}updatePosition(){const t=2*Math.PI*Math.random(),e=.075;this.vx+=e*Math.cos(t),this.vy+=e*Math.sin(t);const s=1.05,i=Math.sqrt(this.vx**2+this.vy**2);i>s&&(this.vx=this.vx/i*s,this.vy=this.vy/i*s),this.x+=this.vx,this.y+=this.vy,this.x>this.sw+this.w/2&&(this.x=-(this.w/2)),this.x+this.w<0&&(this.x=this.sw+this.w/2),this.y>this.sh+this.h/2&&(this.y=-(this.h/2)),this.y+this.h<0&&(this.y=this.sh+this.h/2)}isHit(t){const e=t.getX()-this.x,s=t.getY()-this.y,i=Math.sqrt(e*e+s*s),r=this.r+t.getRadius();return i<r}getColor(){return`#${Math.random().toString(16).slice(-6)}`}getScale(){return this.sw<768?1:1.2}}class y{constructor(t,e){h(this,"x",0);h(this,"y",0);h(this,"w",0);h(this,"h",0);h(this,"r",0);h(this,"color","");h(this,"name","H2");h(this,"vx",0);h(this,"vy",0);this.sw=t,this.sh=e}initializeDrawingProperties(t){const s=document.createElement("canvas").getContext("2d");if(!s)throw new Error("Failed to get canvas 2D context");const i=24*this.getScale();s.font=`${i}px sans-serif`;const r=s.measureText(this.name).width;this.x=t.x,this.y=t.y,this.w=r,this.h=r,this.r=r/2,this.color=this.getColor()}getName(){return this.name}getX(){return this.x}getY(){return this.y}getRadius(){return this.r}render(t){t.textAlign="center",t.textBaseline="middle",t.fillStyle=this.color,t.shadowColor="#888",t.shadowOffsetX=1,t.shadowOffsetY=1,t.shadowBlur=1;const e=24*this.getScale();t.font=`${e}px sans-serif`,t.fillText("H",this.x-this.w/6,this.y);const s=18*this.getScale();t.font=`${s}px sans-serif`,t.fillText("2",this.x+12,this.y+3)}updatePosition(){const t=2*Math.PI*Math.random(),e=.075;this.vx+=e*Math.cos(t),this.vy+=e*Math.sin(t);const s=1.05,i=Math.sqrt(this.vx**2+this.vy**2);i>s&&(this.vx=this.vx/i*s,this.vy=this.vy/i*s),this.x+=this.vx,this.y+=this.vy,this.x>this.sw+this.w/2&&(this.x=-(this.w/2)),this.x+this.w<0&&(this.x=this.sw+this.w/2),this.y>this.sh+this.h/2&&(this.y=-(this.h/2)),this.y+this.h<0&&(this.y=this.sh+this.h/2)}isHit(t){return!1}getColor(){return`#${Math.random().toString(16).slice(-6)}`}getScale(){return this.sw<768?1:1.2}}class x{constructor(t,e){h(this,"x",0);h(this,"y",0);h(this,"w",0);h(this,"isDeletedFlag",!1);this.sw=t,this.sh=e}initializeDrawingProperties(t){const e=(Math.random()*10+18)*this.getScale();this.x=t.x,this.y=t.y,this.w=e}getX(){return this.x}getY(){return this.y}updatePosition(){const t=Math.random()*5;this.x+=Math.cos((this.y+t)/100),this.y+=this.w*.1,this.y>=this.sh&&(this.isDeletedFlag=!0)}render(t){const e=this.w*.4,s=this.x-e,i=this.y-e,r=this.w/2+e,o=t.createRadialGradient(s,i,0,s,i,r);o.addColorStop(0,"rgba(255, 255, 255, 0.6)"),o.addColorStop(1,"rgba(0, 127, 255, 1)"),t.beginPath(),t.arc(this.x,this.y,this.w/2,0,Math.PI*2,!0),t.shadowColor="#007fff",t.shadowOffsetX=1,t.shadowOffsetY=1,t.fillStyle=o,t.fill(),t.closePath()}isDeleted(){return this.isDeletedFlag}getScale(){return this.sw<768?1:1.2}}class p{constructor(t,e){h(this,"x",0);h(this,"y",0);h(this,"w",0);h(this,"h",0);h(this,"r",0);h(this,"color","");h(this,"name","O");h(this,"vx",0);h(this,"vy",0);this.sw=t,this.sh=e}initializeDrawingProperties(t){const s=document.createElement("canvas").getContext("2d");if(!s)throw new Error("Failed to get canvas 2D context");const i=24*this.getScale();s.font=`${i}px sans-serif`;const r=s.measureText(this.getName()).width;this.x=t.x,this.y=t.y,this.w=r,this.h=r,this.r=r/2,this.color=this.getColor()}getName(){return this.name}getX(){return this.x}getY(){return this.y}getRadius(){return this.r}updatePosition(){const t=2*Math.PI*Math.random(),e=.075;this.vx+=e*Math.cos(t),this.vy+=e*Math.sin(t);const s=1.05,i=Math.sqrt(this.vx**2+this.vy**2);i>s&&(this.vx=this.vx/i*s,this.vy=this.vy/i*s),this.x+=this.vx,this.y+=this.vy,this.x>this.sw+this.w/2&&(this.x=-(this.w/2)),this.x+this.w<0&&(this.x=this.sw+this.w/2),this.y>this.sh+this.h/2&&(this.y=-(this.h/2)),this.y+this.h<0&&(this.y=this.sh+this.h/2)}render(t){t.textAlign="center",t.textBaseline="middle";const e=24*this.getScale();t.font=`${e}px sans-serif`,t.fillStyle=this.color,t.shadowColor="#888",t.shadowOffsetX=1,t.shadowOffsetY=1,t.shadowBlur=1,t.fillText(this.getName(),this.x,this.y)}isHit(t){const e=t.getX()-this.x,s=t.getY()-this.y,i=Math.sqrt(e*e+s*s),r=this.r+t.getRadius();return i<r}getColor(){return`#${Math.random().toString(16).slice(-6)}`}getScale(){return this.sw<768?1:1.2}}class v{constructor(){h(this,"h",[]);h(this,"h2",[]);h(this,"o",[]);h(this,"h2o",[]);h(this,"cw");h(this,"ch");h(this,"ctx");h(this,"bufferCanvas");h(this,"bufferCtx");const t=document.querySelector("#myCanvas");if(!t)throw new Error("Canvas element not found");t.width=window.innerWidth,t.height=window.innerHeight,this.cw=t.width,this.ch=t.height;const e=t.getContext("2d");if(!e)throw new Error("Canvas context not available");this.ctx=e,this.bufferCanvas=document.createElement("canvas"),this.bufferCanvas.width=this.cw,this.bufferCanvas.height=this.ch;const s=this.bufferCanvas.getContext("2d");if(!s)throw new Error("Buffer canvas context not available");this.bufferCtx=s}init(t,e){for(let s=0;s<t;s++)this.h.push(this.createHAtom());for(let s=0;s<e;s++)this.o.push(this.createOAtom())}renderFrame(){this.bufferCtx.fillStyle="#fff",this.bufferCtx.fillRect(0,0,this.cw,this.ch),this.renderH(this.h),this.renderH2(this.h2),this.renderO(this.o,this.h2,this.h2o),this.renderH2o(this.h2o),this.ctx.drawImage(this.bufferCanvas,0,0)}getScale(){return this.cw<768?1:this.cw>=768&&this.cw<1280?1.2:1.5}getHLength(){return this.h.length}getH2Length(){return this.h2.length}getOLength(){return this.o.length}getH2oLength(){return this.h2o.length}createHAtom(){const t=this.cw*Math.random(),e=this.ch*Math.random(),s=new m(this.cw,this.ch);return s.initializeDrawingProperties(new c(t,e)),s}createH2Atom(t){const e=new y(this.cw,this.ch);return e.initializeDrawingProperties(t),e}createOAtom(){const t=this.cw*Math.random(),e=this.ch*Math.random(),s=new p(this.cw,this.ch);return s.initializeDrawingProperties(new c(t,e)),s}createH2oAtom(t){const e=new x(this.cw,this.ch);return e.initializeDrawingProperties(t),e}renderH(t){for(let e=0;e<t.length;e++){const s=t[e];s.updatePosition(),s.render(this.bufferCtx);for(let i=e+1;i<t.length;i++){const r=t[i];if(!s.isHit(r))continue;const o=new c(r.getX(),r.getY());this.h2.push(this.createH2Atom(o)),t[e]=this.createHAtom(),t.splice(i,1)}}}renderH2(t){for(const e of t)e.updatePosition(),e.render(this.bufferCtx)}renderO(t,e,s){for(const i of t){i.updatePosition(),i.render(this.bufferCtx);for(const r of e){if(!i.isHit(r))continue;const o=t.indexOf(i);o>=0&&(t[o]=this.createOAtom());const f=e.indexOf(r);f>=0&&e.splice(f,1),this.h.push(this.createHAtom()),s.push(this.createH2oAtom(new c(i.getX(),i.getY())))}}}renderH2o(t){for(let e=t.length-1;e>=0;e--){const s=t[e];if(s.updatePosition(),s.isDeleted()){t.splice(e,1);continue}s.render(this.bufferCtx)}}}const a=class a{constructor(){h(this,"measurement");h(this,"values",[]);h(this,"frameCnt",1);h(this,"elapsedTime",0);h(this,"timeStr","");this.measurement=document.createElement("div"),this.measurement.style.position="absolute",this.measurement.style.top="0px",this.measurement.style.color="aqua",this.measurement.style.backgroundColor="rgba(0, 0, 0, 0.5)",this.measurement.style.padding="3px 5px",document.body.appendChild(this.measurement)}static factory(){return a.instance||(a.instance=new a),a.instance}measure(t,e=""){const s=performance.now();t();const i=performance.now();return this.elapsedTime+=Math.floor(i)-Math.floor(s),this.frameCnt===1||this.frameCnt%60===0?(this.timeStr=(this.elapsedTime/this.frameCnt).toPrecision(4),this.add(`${this.timeStr}ms`)):this.add(`${e}${this.timeStr}ms`),this.frameCnt++,this}add(t){return this.values.push(t),this}render(){this.measurement.innerText=this.values.join(`
`),this.values.length=0}};h(a,"instance",null);let l=a;const S=window.location.search,d=new URLSearchParams(S),C=d.get("m")==="1",u=(n,t)=>{const e=Number.parseInt(n||"",10);return Number.isNaN(e)?t:e},H=u(d.get("h"),30),M=u(d.get("o"),50);window.addEventListener("DOMContentLoaded",()=>{const n=new v,t=n.getScale();n.init(H*t,M*t);const e=()=>{C?l.factory().measure(()=>n.renderFrame()).add(`H: ${n.getHLength()}`).add(`H2: ${n.getH2Length()}`).add(`O: ${n.getOLength()}`).add(`H2o: ${n.getH2oLength()}`).render():n.renderFrame(),requestAnimationFrame(e)};e()});
